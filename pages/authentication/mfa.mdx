import { Callout, Tab, Tabs, Steps } from "nextra-theme-docs";

# Multi-Factor Authentication

ROQ provides an additional layer of protection, which is **Multi-Factor Authentication** or called **MFA**. With this security enhancement, you can use your phone number as additional application authentication.

## MFA SMS Setup

There are a few steps need to be done on the ROQ Console before using the Multi-factor Authentication with SMS.

<Steps>
### Enable SMS Integrations

To utilize MFA through SMS on ROQ, you must enable SMS integration in the ROQ Console. This can be done by going to the **Integrations** → **SMS** menu and then activate the integrations. 

<Callout type="info">
Please note that at least one active SMS integration is required.
</Callout>

![](/mfa-enable-sms-integration.png)

{/*
#### Twilio

To integrate Twilio SMS with ROQ you should  fill the sender number in the SMS integration form configuration.

*/}

### Enable MFA on Authentication Configuration

The next step is to enable MFA on the registration or login form in the ROQ Console. 

Go to the **Authentication** → **Configuration**. You can enable MFA for each registration form variant by selecting the **Two-factor Authentication** flag.

![enable mfa on auth config](/mfa-enable-auth-configuration.png)

<Callout type="info">
This configuration will impact new users who register. To implement MFA for current users, please follow the next steps. 
</Callout>

### Enable MFA for Existing Users

To activate Multi-factor Authentication for the existing users, you need to turn on the MFA option in the ROQ Console. Navigate to the **Users & Access** → **Users** section and choose the specific users you wish to enable MFA for.

There are two settings that require attention:

- **Two-factor Authentication**: Enable this option to apply MFA to the selected user.
- **Phone**: Enter your phone number, which will be used to send the OTP for login verification. {/* This can be change later on the user account in the generated application or in the MFA form.*/}

![enable two factor auth for a user](/mfa-enable-user-two-factor-auth.png)

</Steps>

Once the above steps have been completed, users will have access to the Multi-factor Authentication feature.

## MFA for Existing Users

Next, when the existing users with MFA enabled try to login, the user will be asked to enter a verification code. The user workflow can be described as steps below:

<Steps>

### Enter OTP

ROQ will send a One-Time Password or OTP to the user phone number registered on the ROQ Console ([Step 3](/authentication/mfa#enable-mfa-for-existing-users) on MFA SMS Setup) for login verification.

![mfa user verification code](/mfa-user-send-verification-code.png)

You can also change the number in case you have entered the wrong phone number before by clicking the **Change phoner number**.

### Recovery codes

Users with successful verification will get the recovery codes, which can be saved through manual copy-paste or downloading the recovery codes file.

![mfa recovery codes](/mfa-recovery-codes.png)

<Callout type="warning">
The recovery codes will only be displayed once. Please ensure you keep them safe and confidential.
</Callout>

</Steps>


## MFA for New Users

For a new user, MFA will be applied after successful registration. The user workflow can be shown in the steps below:

<Steps>

### Enter Phone Number

After registering successfully, new users will be prompted to provide their phone number in order to receive an OTP SMS as an additional authentication.

![ask phone number](/mfa-new-user-ask-phone.png)

### Enter OTP  

The next steps are the same for existing users. You will need to enter the OTP into the MFA form for verification.

![mfa user verification code](/mfa-user-send-verification-code.png)

### Recovery Codes

You will receive a list of recovery codes that you should backup either by copying and pasting or by downloading the recovery codes file.

![mfa recovery codes](/mfa-recovery-codes.png)


</Steps>

## Disable MFA

If the Two-Factor Authentication flag is turned off in the ROG Console authentication settings, users will not need to confirm their login even if they have MFA enabled.
